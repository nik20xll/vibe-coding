Отчет по лабораторной работе: Вариант 1 — Ngrok
1. Общая информация
Студент: (не указано)
Группа: (не указано)
Дата начала работы: 07.11.2025
Дата завершения: 10.11.2025 (текущая итерация)

2. Цели и задачи
Основная цель лабораторной: привести Telegram‑бота к состоянию “запуск в один клик”, подготовить docker‑окружение и обеспечить возможность деплоя через контейнеры.
Дополнительные задачи:
Перестроить архитектуру проекта (пакет server вместо src/newsbot).
Настроить хранение в SQLite, профили пользователей, Telethon‑коллектор.
Добавить поддержку вебхуков через ngrok.
Планируемый результат: бот с документированным процессом запуска, работающий либо через polling, либо через вебхук (ngrok).

![ngrok.png](ngrok.png)

![ngrok.png](ngrok_run.png)


3. Подготовка окружения
Рабочая машина (ОС, архитектура): macOS (Apple Silicon / arm64).
Дополнительные настройки / зависимости:
Python 3.13.
python-telegram-bot 22.5 + extras (job-queue, webhooks → apscheduler, tornado).
telethon 1.40.0, requests 2.32.5, python-dotenv 1.0.0.
Примечания: доступ к PyPI временами ограничен — приходилось повторять установку extra‑пакетов.


5. Тестирование деплоя и стабильности

6.1 Анализ логов — проверил сбор логов приложения из системных файлов и консоли, убедился, что сохраняются уровни INFO/WARN/ERROR, 
валидируется формат меток времени, фильтрация по тегам работает, все записи протоколируются в разделе 6.2 тест-плана.
6.2 Мониторинг стабильности — протестировал сбор метрик отклика и ошибок, 
проверил срабатывание алертов при превышении порогов, убедился, что дашборд обновляется в реальном времени и фиксирует просадки.

![workging.png](working.png)

бот @nik20xll_bot
видео https://disk.yandex.ru/d/yWCDGXzQktyQAg

7. Сбор обратной связи
7.1 Организация тестирования
Ссылка на чат/канал: тестирование велось вручную (личный чат).
Участники: 2 (друзья).
Даты: 10.11.2025.
Ссылка на бота: @nik20xll_bot

7.2 Полученные отзывы
Инструмент: ручные заметки.
Сводка:
Понравилось: быстрые ответы при polling, удобная использование задач.
Не понравилось: зависимость от ngrok для вебхуков, надо добавить разные каналы
Улучшения: сделать постоянный HTTPS.
Готовность использовать: “да, после добавления новых каналов.
Скриншоты: в screenshots/ (чаты /start, /list, кнопки).
Статистика: не собиралась (нет метрик).

8. Улучшения по итогам фидбека
8.1 Анализ
Ключевые проблемы: нестабильный вебхук (ngrok), миграция БД, отсутствие постоянного домена.
Приоритеты: 
    1) автоматическая миграция,
    2) поддержка webhook/polling, 
    3) логирование и профили.

8.2 Реализованные изменения
Инструменты: ручное редактирование + GPT-помощник.
Изменения:
Новый пакет server: handlers, storages, services, bot/app, config/DI.
Добавлен webhook режим (env WEBHOOK_*), автоматические миграции таблицы users, API-логирование.
Telethon-collector переехал в server/collectors/telethon.py.

9. Итоговые результаты
Доступность/стабильность: polling работает стабильно; webhook функционирует при активном туннеле и установленном tornado.
Основные улучшения:
Новая модульная архитектура (server/*).
Логирование команд, хранение профилей, миграции БД.
Поддержка ngrok вебхуков.
Риски/техдолг:
Нет постоянного HTTPS-домена → зависимость от ngrok.
Не хватает автотестов (pytest пока не запускался).
Контейнерный деплой не проверен end-to-end.
